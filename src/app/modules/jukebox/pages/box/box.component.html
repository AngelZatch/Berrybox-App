<div *ngIf="!loading">
    <div class="box-space row no-gutters">
        <div class="col-9">
            <div id="player">
                <app-player #player [boxToken]="box._id" [video]="currentVideo" (state)="onPlayerStateChange($event)">
                </app-player>
            </div>
            <div class="row under-player">
                <div class="col-4 box-info">
                    <div class="d-flex">
                        <div class="bb-box-picture d-flex align-items-center justify-content-center mr-2">
                            <img src="{{ pictureLocation }}" alt="{{ box?.creator?.nameÂ }}"
                                (error)="loadDefaultPicture()" class="profile-picture profile-picture-md">
                        </div>
                        <div class="bb-box-info w-100">
                            <div id="box-title-space">
                                <div id="box-title">
                                    <span class="closed-label" *ngIf="!box?.open"
                                        ngbTooltip="The box is closed. Video play and submission are disabled.">Closed</span>
                                    <span class="box-title" title="{{box.name}}">{{ box.name }}</span>
                                </div>
                                <div class="d-flex align-items-center" ngbTooltip="Settings"
                                    *ngIf="user._id === box?.creator?._id" (click)="openBoxSettings()">
                                    <svg class="berrybox-svg" style="height: 1.4em;" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 550 550">
                                        <rect class="berrybox-path" x="205.98" y="50.17" width="138.04" height="56" />
                                        <rect class="berrybox-path" x="205.98" y="445.83" width="138.04" height="56" />
                                        <rect class="berrybox-path" x="374.83" y="143.92" width="138.04" height="56"
                                            transform="translate(359.31 -296.5) rotate(58.6)" />
                                        <rect class="berrybox-path" x="37.12" y="350.08" width="138.04" height="56"
                                            transform="translate(373.54 90.48) rotate(58.6)" />
                                        <rect class="berrybox-path" x="372.85" y="353.26" width="138.04" height="56"
                                            transform="translate(1000.81 213.34) rotate(122.49)" />
                                        <rect class="berrybox-path" x="39.11" y="140.74" width="138.04" height="56"
                                            transform="translate(308.54 168.16) rotate(122.49)" />
                                        <path class="berrybox-path"
                                            d="M275,79.67C167.12,79.67,79.67,167.12,79.67,275S167.12,470.33,275,470.33,470.33,382.88,470.33,275,382.88,79.67,275,79.67Zm0,297.72A102.39,102.39,0,1,1,377.39,275,102.39,102.39,0,0,1,275,377.39Z" />
                                    </svg>
                                </div>
                            </div>
                            <div class="d-flex">
                                <div class="col-4 p-0">
                                    <svg class="berrybox-svg-icon crown" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 500 500" title="Administrator">
                                        <rect x="29.61" y="209.46" width="440.78" height="181.69" />
                                        <polygon points="250 53.84 148.6 229.46 351.4 229.46 250 53.84" />
                                        <polygon points="470.39 54.84 368.99 230.46 470.39 230.46 470.39 54.84" />
                                        <polygon points="131.01 230.46 29.61 54.84 29.61 230.46 131.01 230.46" />
                                    </svg>
                                    <span class="ml-1">{{ box?.creator?.name }}</span>
                                </div>
                                <div class="col d-flex flex-row-reverse pr-0">
                                    <div class="box-option" *ngIf="box?.options?.random === true"
                                        ngbTooltip="The next video will be picked at random from the upcoming pool."
                                        placement="top">
                                        Random
                                    </div>
                                    <div class="box-option" *ngIf="box?.options?.loop === true"
                                        ngbTooltip="The system will automatically requeue old videos." placement="top">
                                        Loop
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-8 video-info" *ngIf="currentVideo">
                    <div class="row">
                        <div class="col-10 d-flex justify-content-start align-items-center">
                            <img *ngIf="currentVideo?.stateForcedWithBerries" src="../../../../../assets/images/icons/berry-coin-icon.svg" alt=""
                                style="height: 30px;" ngbTooltip="This video is playing thanks to the use of berries.">
                            <p class="video-title" title="{{currentVideo?.video.name}}">{{currentVideo?.video.name}}</p>
                        </div>
                        <div class="col-2 text-right" *appAuth="true">
                            <app-bx-button *ngIf="user._id === box.creator._id" (click)="skipVideo()"
                                [options]="{'type': 'skip', 'textDisplay': 'tooltip', 'context': 'queue'}" class="mr-2">
                            </app-bx-button>
                            <app-bx-button *ngIf="user._id !== box.creator._id" (click)="skipVideo()"
                                [options]="{'type': 'skip', 'textDisplay': 'tooltip', 'context': 'berries', 'text': 'Spend 30 berries to skip'}"
                                class="mr-2">
                            </app-bx-button>
                            <app-bx-button *ngIf="currentVideo" (click)="addToPlaylist()"
                                [options]="{'type': 'addToLibrary', 'textDisplay': 'tooltip', 'text': 'Add to a Playlist', 'context': 'queue'}">
                            </app-bx-button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-9">
                            <span class="minor-text">Submitted by {{ currentVideo?.submitted_by?.name }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <app-panel class="col-3" id="room-panel" #panel [boxToken]="box._id"></app-panel>
    </div>
</div>